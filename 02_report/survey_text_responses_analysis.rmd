---
title: "Survey Text Analysis"
author: "Chris Selig"
date: "`r Sys.Date()`"
output: 
    tufte::tufte_html: default

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    echo = F,
    warning = F,
    message = F,
    fig.align = 'center'
    )
```

```{r load libraries}
# rmd theme
library(tufte)

# Workhorse: data manipulation, plotting
library(tidyverse)
library(janitor)

# Read in data
library(readxl)

# Text specific packages
library(tidytext)
library(stopwords)

# Visualization packages
library(ggthemes)
library(wordcloud)
```


```{r load data}
raw_data <- read_excel("../00_data/survey_text_responses.xlsx",sheet = "Survey_responses")
keyword <- read_excel("../00_data/keywords.xlsx")
```

```{r source scripts}
source("../01_scripts/01_data_processing.R")
source("../01_scripts/02_visualizations.R")
```

```{r set theme for plots}
# Set theme
theme_set(theme_tufte())
```


```{r unigrams data processing}
unigram_tidy_data <- raw_data %>% 
    clean_column_names_function() %>% 
    tokenize_data_function() %>% 
    remove_stop_words_function()
```

## Purpose

The purpose of this analysis is to analyze the four open ended questions in a survey for customer satisfaction for VHT's products.

The four questions are:

1. If you could change anything about the services VHT Studios offers, what would it be? Tagged as "Change 1 thing" in dataset.

2. What can we do better? Tagged as "do better" in dataset.

3. What other capabilities would you be interested in VHT offering? Tagged as "Other Services" in dataset.

4. Additional Comments and/or Suggestions for improvements or changes. Tagged as "Other Comments" in dataset.


## Most Common Words Overall

First, I look at the most common words overall. Note, stop words are removed. Stop words are extremely common words like "and", "a", and "the" and offer no meaning for analytical purposes.

```{r}
set.seed(100)

unigram_tidy_data %>% 
    count(word) %>% 
    with(wordcloud(word, n, max.words = 100))
```


The wordcloud above shows the top 100 words used by the respondents. Photographer is the most frequent word, which really isn't a big surprise, but some other interesting ones are 'service', 'time','pricing' and 'quicker'.


## Visualize Most Common Single Words by Question


The below image shows the single most frequent words that appear on each of the four open ended questions.


Some observations:

1. Pricing seems to be pretty popular in the "change 1 thing" question as it appears twice, as price and pricing.

2. Photos appears the most times in both the "change 1 thing" and "do better" questions. That would be something else to explore. 

3. The "other services" questions has some interesting words, like video and drone. Both are services offered so it would be interesting to see the context.


```{r unigram visual}
barchart_function(
    data = unigram_tidy_data, 
    title = "Top 10 Single Words for Each Open Question"
    )
```


## Common Bigrams - Two words that appear side by side

The next section will show two words that often appear together. Note, bigrams appear less frequently than single words so counts will be lower.


```{r bigrams data processing}
bigram_tidy_data <- raw_data %>% 
    clean_column_names_function() %>% 
    ngram_data_function()
```

```{r bigram visual}
bigram_tidy_data %>% 
    barchart_function(
        title = "Top 10 Bigrams by Question",
        subtitle = "More than 10 bigrams appear due to ties"
    )
```

Bigrams are a little more interesting than unigrams because you can start to see some context around the verbage in the questions.

1. Virtual staging appers most frequently in the "change 1 thing" and other services questions, while it is second place in the "do better" and "other comments" questions.

2. "Gold package" makes the top 10 in the "do better" question.

3. "Customer service" is number 1 in "do better"

4. "Floor plan(s)" appears twice in the "change 1 thing" question


## Common Trigrams - Three words that appear side by side


## Topic Modeling


## Single Word Sentiment Wordcloud


## Sentence Sentiment


## Keyword Search